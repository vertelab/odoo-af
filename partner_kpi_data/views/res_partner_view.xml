<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_partner_form" model="ir.ui.view">
        <field name="name">res.partner.view.form.inherit.kpi</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='internal_notes']" position="after">
                <page string="KPI" attrs="{'invisible':[('is_company', '=', False)]}">
                    <group>
                        <field name="kpi_ids" mode="tree" nolabel="1">
                            <tree editable="bottom" string="KPI" default_order="fiscal_year desc">
                                <field name="fiscal_year" widget="date"/>
                                <field name="size"/>
                                <field name="turnover"/>
                                <field name="turnover_change"/>
                                <field name="turnover_change_percent"/>
                                <field name="profit"/>
                                <field name="profit_percent"/>
                                <field name="profit_change"/>
                                <field name="profit_change_percent"/>
                                <field name="employees"/>
                                <field name="employees_change"/>
                                <field name="employees_change_percent"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <record id="kpi_action" model="ir.actions.act_window">
        <field name="name">KPI</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner.kpi</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree</field>
    </record>

    <record id="kpi_view_tree" model="ir.ui.view">
        <field name="name">kpi.tree</field>
        <field name="model">res.partner.kpi</field>
        <field name="arch" type="xml">
            <tree editable="bottom" string="KPI">
                <field name="partner_id" groups="base.group_no_one"/>
                <field name="fiscal_year" widget="date"/>
                <field name="size"/>
                <field name="turnover"/>
                <field name="turnover_change"/>
                <field name="turnover_change_percent"/>
                <field name="profit"/>
                <field name="profit_percent"/>
                <field name="profit_change"/>
                <field name="profit_change_percent"/>
                <field name="employees"/>
                <field name="employees_change"/>
                <field name="employees_change_percent"/>
            </tree>
        </field>
    </record>

    <!-- <record id="view_kpi_pivot" model="ir.ui.view">
       <field name="name">kpi.pivot</field>
       <field name="model">res.partner.kpi</field>
       <field name="arch" type="xml">
           <pivot string="kpi">
               <field name="partner_id" type="row"/>
           </pivot>
       </field>
   </record>

    <record id="view_kpi_graph" model="ir.ui.view">
       <field name="name">kpi.graph</field>
       <field name="model">res.partner.kpi</field>
       <field name="arch" type="xml">
           <graph string="kpi">

           </graph>
       </field>
   </record> -->

    <record id="kpi_action_view_tree" model="ir.actions.act_window.view">
        <field name="act_window_id" ref="kpi_action"/>
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="kpi_view_tree"/>
    </record>

    <!-- <record id="action_view_view_kpi_pivot" model="ir.actions.act_window.view">
      <field name="act_window_id" ref="kpi_action"/>
      <field name="sequence" eval="2"/>
      <field name="view_mode">pivot</field>
      <field name="view_id" ref="view_kpi_pivot"/>
  </record>

    <record id="action_view_view_kpi_graph" model="ir.actions.act_window.view">
      <field name="act_window_id" ref="kpi_action"/>
      <field name="sequence" eval="3"/>
      <field name="view_mode">graph</field>
      <field name="view_id" ref="view_kpi_graph"/>
  </record>     -->


    <menuitem id="partner_kpi_menu_tree" name="KPI" parent="contacts.menu_contacts" action="kpi_action"/>

    <record id="view_partner_form_kpi1" model="ir.ui.view">
        <field name="name">res.partner.kpi.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="partner_view_360.view_partner_employer_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='contacts_addresses']" position="after">
                <page string="KPI">
                    <group>
                        <field name="kpi_ids" mode="tree" nolabel="1">
                            <tree editable="bottom" string="KPI" default_order="fiscal_year desc">
                                <field name="fiscal_year" widget="date"/>
                                <field name="size"/>
                                <field name="turnover"/>
                                <field name="turnover_change"/>
                                <field name="turnover_change_percent"/>
                                <field name="profit"/>
                                <field name="profit_percent"/>
                                <field name="profit_change"/>
                                <field name="profit_change_percent"/>
                                <field name="employees"/>
                                <field name="employees_change"/>
                                <field name="employees_change_percent"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <menuitem id="partner_kpi_menu_tree_employer" name="KPI" parent="partner_view_360.res_partner_employers_menu"
              action="kpi_action"/>

    <record id="partner_kpi_search" model="ir.ui.view">
        <field name="name">res.partner.kpi.search</field>
        <field name="model">res.partner.kpi</field>
        <field name="arch" type="xml">
            <search string="Search KPI">

                <field name="partner_id" domain="[('partner_id', 'ilike', self)]"/>
                <!-- <field name="fiscal_year" />

                <field name="turnover" />
                <field name="profit"/>
                <field name="employees" />

                <field name="turnover_change" />
                <field name="profit_change"/>
                <field name="employees_change" />

                <field name="turnover_change_percent"/>
                <field name="profit_change_percent"/>
                <field name="employees_change_percent"/> -->

                <filter name="size" string="Size class 1" domain="[('size', '=', '1')]"/>
                <filter name="size" string="Size class 2" domain="[('size', '=', '2')]"/>
                <filter name="size" string="Size class 3" domain="[('size', '=', '3')]"/>
                <filter name="size" string="Size class 4" domain="[('size', '=', '4')]"/>
                <filter name="size" string="Size class 5" domain="[('size', '=', '5')]"/>
                <filter name="size" string="Size class 6" domain="[('size', '=', '6')]"/>
                <filter name="size" string="Size class 7" domain="[('size', '=', '7')]"/>
                <filter name="size" string="Size class 8" domain="[('size', '=', '8')]"/>
                <filter name="size" string="Size class 9" domain="[('size', '=', '9')]"/>

            </search>
        </field>
    </record>

</odoo>

